from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.linear_model import LogisticRegression
from sklearn.model_selection import StratifiedKFold, cross_val_score

descriptions = [
    # СОБАКА
    "гавкает и охраняет дом",
    "умеет приносить палку",
    "лучший друг человека",
    "живет с человеком и лает",
    "быстро бегает и любит играть",

    # КОШКА
    "мяукает и любит молоко",
    "пушистая и ловит мышей",
    "любит играть с клубком ниток",
    "ходит мягко и мурлычет",
    "любит спать целый день",

    # ЛЯГУШКА
    "квакает и прыгает",
    "живет возле воды и ловит мух",
    "маленькая зелёная прыгает",
    "ест комаров",
    "умеет квакать",

    # ЖИРАФ
    "длинная шея ест листья",
    "высокое животное живет в африке",
    "ест листья с деревьев",
    "очень высокий с пятнами",
    "пасется на саванне",

    # УЛИТКА
    "живет в ракушке",
    "ползает медленно и носит дом",
    "оставляет слизь",
    "маленькая и мягкая в панцире",
    "ползает по земле очень медленно",

    # ЛЕВ
    "царь зверей с гривой",
    "живет в прайде",
    "охотник на саванне",
    "большой и сильный",
    "рычит и нападает",

    # ТИГР
    "полосатый хищник джунглей",
    "большой и сильный",
    "быстро бегает и охотится",
    "любит воду и охотится ночью",

    # МЕДВЕДЬ
    "большой и коричневый",
    "живёт в лесу",
    "любит мёд",
    "может быть опасным",
    "спит зимой в берлоге",

    # ВОЛК
    "выть на луну",
    "живёт в стае",
    "охотник на других животных",
    "серый и пушистый",
    "быстро бегает по лесу",

    # ЛИСА
    "рыжая и хитрая",
    "пушистый хвост",
    "ловко охотится",
    "живёт в лесу",
    "маленькая и быстрая",

    # ОБЕЗЬЯНА
    "прыгает по деревьям",
    "ест бананы",
    "умная и любопытная",
    "имеет хвост",
    "живёт в тропиках",

    # ПАНДА
    "черно-белая",
    "ест бамбук",
    "живёт в Китае",
    "медленная и пушистая",

    # СЛОН
    "огромный с длинным хоботом",
    "большие уши",
    "тяжёлый",
    "живёт в Африке или Азии",

    # ПИНГВИН
    "черно-белый",
    "ходит как человек",
    "живёт в Антарктиде",
    "плавает в холодной воде",

    # ДЕЛЬФИН
    "умный морской млекопитающий",
    "плавает быстро",
    "любит прыгать",
    "живёт в океане",

    # КОРОВА
    "домашнее животное",
    "дает молоко",
    "большая и мирная",
    "пастись на лугу",

    # КЕНГУРУ
    "прыгает высоко",
    "длинные задние ноги",
    "живёт в Австралии",
    "носит детёныша в сумке",

    # КРОКОДИЛ
    "живет в воде",
    "опасный хищник",
    "имеет крупные зубы",
    "ползает медленно на суше",

    # ЛОСЬ
    "огромные рога",
    "живёт в тундре",
    "большой и тяжёлый",
    "питается травой",

    # ПТИЦА
    "летает в небе",
    "имеет крылья",
    "откладывает яйца",
    "разные виды и окрасы"
]

animals = [
    "собака","собака","собака","собака","собака",
    "кошка","кошка","кошка","кошка","кошка",
    "лягушка","лягушка","лягушка","лягушка","лягушка",
    "жираф","жираф","жираф","жираф","жираф",
    "улитка","улитка","улитка","улитка","улитка",
    "лев","лев","лев","лев","лев",
    "тигр","тигр","тигр","тигр",
    "медведь","медведь","медведь","медведь","медведь",
    "волк","волк","волк","волк","волк",
    "лиса","лиса","лиса","лиса","лиса",
    "обезьяна","обезьяна","обезьяна","обезьяна","обезьяна",
    "панда","панда","панда","панда",
    "слон","слон","слон","слон",
    "пингвин","пингвин","пингвин","пингвин",
    "дельфин","дельфин","дельфин","дельфин",
    "корова","корова","корова","корова",
    "кенгуру","кенгуру","кенгуру","кенгуру",
    "крокодил","крокодил","крокодил","крокодил",
    "лось","лось","лось","лось",
    "птица","птица","птица","птица"
]

# ---- Модель ----
# Используем символьные n-граммы, чтобы лучше ловить похожие слова
vectorizer = TfidfVectorizer(
    analyzer="char",
    ngram_range=(3, 5),
    lowercase=True,
    strip_accents="unicode"
)
X = vectorizer.fit_transform(descriptions)
y = animals

base_model = LogisticRegression(max_iter=5000)
cv = StratifiedKFold(n_splits=5, shuffle=True, random_state=42)
cv_scores = cross_val_score(base_model, X, y, cv=cv)
print(f"Средняя точность по кросс-валидации: {cv_scores.mean():.2%}")

model = LogisticRegression(max_iter=5000)
model.fit(X, y)

# ---- Предсказания ----
while True:
    text = input("\nВведите описание животного: ")
    vec = vectorizer.transform([text])
    print("Это животное:", model.predict(vec)[0])
