import random
import datetime

start_time = datetime.datetime.now()
log_file = f"bandeshmyg_log_{start_time.strftime('%Y%m%d_%H%M%S')}.txt"

def log(msg):
    ts = datetime.datetime.now().strftime("%H:%M:%S")
    with open(log_file, "a", encoding="utf-8") as f:
        f.write(f"[{ts}] {msg}\n")

def choose(prompt, options):
    while True:
        ans = input(prompt)
        if ans in options:
            return ans
        print("üí•–ù–µ–≤–µ—Ä–Ω–æ, –ø–æ–ø—Ä–æ–±—É–π –µ—â—ë.")

def roll_die():
    return random.randint(1,6)

def duel(monster_name):
    print(f"\n–ü–µ—Ä–µ–¥ —Ç–æ–±–æ–π {monster_name}. –¢–µ–±–µ –Ω—É–∂–Ω–æ –≤—ã–∏–≥—Ä–∞—Ç—å –µ–≥–æ 3 —Ä–∞–∑–∞ –ø–æ–¥—Ä—è–¥ –≤ –∫–æ—Å—Ç–∏üé≤.")
    log(f"–ù–∞—á–∞–ª–æ —Ç–µ—Å—Ç–∞ —É–¥–∞—á–∏ —Å {monster_name}")
    for attempt in range(1,4):
        input(f"–†–∞—É–Ω–¥ {attempt}: –Ω–∞–∂–º–∏ Enter –¥–ª—è –±—Ä–æ—Å–∫–∞ –∫–æ—Å—Ç–∏üé≤...")
        player = roll_die()
        enemy = roll_die()
        print(f"–¢–´-{player} vs {monster_name}-{enemy}")
        log(f"–†–∞—É–Ω–¥ {attempt}: –¢–´-{player} vs {monster_name}-{enemy}")
        if player <= enemy:  # –µ—Å–ª–∏ –∏–≥—Ä–æ–∫ –º–µ–Ω—å—à–µ –∏–ª–∏ —Ä–∞–≤–Ω–æ ‚Äî –ø—Ä–æ–∏–≥—Ä—ã—à
            print("üí•–¢—ã –ø—Ä–æ–∏–≥—Ä–∞–ª(–∞)! –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ —Ä–∞–∑–≤–∏–ª–∫—É.")
            log(f"üí•–ò–≥—Ä–æ–∫ –ø—Ä–æ–∏–≥—Ä–∞–ª –ø—Ä–æ—Ç–∏–≤ {monster_name} –≤ —Ä–∞—É–Ω–¥–µ {attempt}")
            return False
        else:
            print("–†–∞—É–Ω–¥ –≤—ã–∏–≥—Ä–∞–Ω!")
    print(f"üî•–¢—ã –ø–æ–±–µ–¥–∏–ª(–∞) {monster_name}! –ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Å–µ–≥–æ–¥–Ω—è —É–¥–∞—á–∞ –Ω–∞ —Ç–≤–æ–µ–π —Å—Ç–æ—Ä–æ–Ω–µ!,üî• ")
    print('–ù—É –∞ —Ç–µ–ø–µ—Ä—å :)')
    log(f"üî•–ò–≥—Ä–æ–∫ –ø–æ–±–µ–¥–∏–ª {monster_name}")
    return True

def left_path():
    log("–ò–≥—Ä–æ–∫ –ø–æ—à—ë–ª –Ω–∞–ª–µ–≤–æ")
    print("\n--- –õ–ï–í–û: –°–∫–µ–ª–µ—Ç –∏ –í–∏–Ω–¥–∏–≥–æ ---")
    if not duel("–°–∫–µ–ª–µ—Ç"):
        return False
    if not duel("–í–∏–Ω–¥–∏–≥–æ"):
        return False
    print("\n–¢—ã –ø–æ–±–µ–¥–∏–ª(–∞) –æ–±–æ–∏—Ö! –ß—É–≤–∞–∫ —Ç–µ–±–µ —Ä–µ–∞–ª—å–Ω–æ –Ω–∞–¥–æ –ø–æ–π—Ç–∏ –∏ –ø–æ—Å—Ç–∞–≤–∏—Ç—å –≤—Å–µ –Ω–∞ –∫—Ä–∞—Å–Ω–æ–µüé∞")
    log("üî•–ò–≥—Ä–æ–∫ –ø–æ–±–µ–¥–∏–ª –æ–±–æ–∏—Ö –º–æ–Ω—Å—Ç—Ä–æ–≤ ‚Äî –≤—ã—Ö–æ–¥ –Ω–∞–π–¥–µ–Ω")
    return True

def forward_path():
    log("–ò–≥—Ä–æ–∫ –ø–æ—à—ë–ª –≤–ø–µ—Ä—ë–¥")
    print("\n--- –í–ü–ï–†–Å–î: 10 –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—Ä–∏–º–µ—Ä–æ–≤ –æ—Ç –ó–æ–º–±–∏–®—Ç–µ–π–Ω–∞ ---")
    for i in range(1,11):
        a = random.randint(5,1000)
        b = random.randint(1,100)
        c = random.randint(1,10)
        correct = a + b - c
        ans = input(f"–ü—Ä–∏–º–µ—Ä {i}: {a}+{b}-{c}=  ")
        log(f"–ü—Ä–∏–º–µ—Ä {i}: {a}+{b}*{c}={correct}, –æ—Ç–≤–µ—Ç –∏–≥—Ä–æ–∫–∞ {ans}")
        if ans != str(correct):
            print("üí•–ì–ª—É–ø—ã–π –æ—Ç–≤–µ—Ç! –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ —Ä–∞–∑–≤–∏–ª–∫—É...")
            return False
    print("üî•–í—Å–µ 10 –ø—Ä–∏–º–µ—Ä–æ–≤ —Ä–µ—à–µ–Ω—ã! –ó–æ–º–±–∏–®—Ç–µ–π–Ω –≤ —à–æ–∫–µ —Å —Ç–≤–æ–µ–≥–æ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –Ω–µ–π—Ä–æ–Ω–∞–º–∏. –¢—ã –Ω–∞—à—ë–ª(–ª–∞) –≤—ã—Ö–æ–¥ –∏–∑ –ø–æ–¥–∑–µ–º–µ–ª—å—è.")
    log("üî•–ò–≥—Ä–æ–∫ —Ä–µ—à–∏–ª –≤—Å–µ –ø—Ä–∏–º–µ—Ä—ã ‚Äî –≤—ã–∏–≥—Ä–∞–ª (–≤–ø–µ—Ä–µ–¥)")
    return True

RIDDLES = [
    ("–ö–∞–∫–æ–µ –∏–∑–æ–±—Ä–µ—Ç–µ–Ω–∏–µ —Å—Ç–∞–ª–æ –ø–µ—Ä–≤—ã–º –≤ –ø–æ—Å–ª—É–∂–Ω–æ–º —Å–ø–∏—Å–∫–µ –¢–æ–º–∞—Å–∞  –≠–¥–∏—Å–æ–Ω–∞?", ["1) –ø—Ä–æ–µ–∫—Ç–æ—Ä","2) –ª–∞–º–ø–∞ –Ω–∞–∫–∞–ª–∏–≤–∞–Ω–∏—è","3) —Ñ–æ–Ω–æ–≥—Ä–∞—Ñ"], "3"),
    ("–ë–ª–∞–≥–æ–¥–∞—Ä—è —á–µ–º—É –∑–≤—É—á–∏—Ç –ø–∏–∞–Ω–∏–Ω–æ?", ["1) —Ç—Ä—É–±–∞–º","2) —Å—Ç—Ä—É–Ω–∞–º","3) —Å–∂–∞—Ç–æ–º—É –≤–æ–∑–¥—É—Ö—É"], "2"),
    ("–í –∫–∞–∫–æ–π –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–æ–π –∫–æ–º–ø–æ–∑–∏—Ü–∏–∏ —Ç—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω–æ –∑–≤—É—á–∏—Ç –ø—É—à–µ—á–Ω—ã–π –≤—ã—Å—Ç—Ä–µ–ª?", ["1) 1812","2) –í—Ä–µ–º–µ–Ω–∞ –≥–æ–¥–∞","3) –ö–æ–Ω—Ü–µ—Ä—Ç 1"], "1"),
    ("–ì–¥–µ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –¢—É–Ω–∏—Å?", ["1) –ê—Ñ—Ä–∏–∫–∞","2) –ê–∑–∏—è","3) –ë–ª–∏–∂–Ω–∏–π –í–æ—Å—Ç–æ–∫"], "1"),
    ("–ß—Ç–æ —Ç–∞–∫–æ–µ –±–∏–∫–∞—Ä–±–æ–Ω–∞—Ç –Ω–∞—Ç—Ä–∏—è?", ["1) —É–∫—Å—É—Å","2) –ø–æ–≤–∞—Ä–µ–Ω–Ω–∞—è —Å–æ–¥–∞","3) –∫–æ–Ω–¥–∏—Ç–µ—Ä—Å–∫–∏–µ –æ—Å—Ç–∞—Ç–∫–∏"], "2"),
    ("–ö–∞–∫–æ–π —Ü–≤–µ—Ç–æ–∫ —Ä–∞–Ω—å—à–µ –Ω–∞–∑—ã–≤–∞–ª–∏ '–∫—Ä–∏–Ω'?", ["1) –ª–∞–Ω–¥—ã—à","2) —Ç—é–ª—å–ø–∞–Ω","3) –ª–∏–ª–∏—è"], "3"),
    ("–í –∫–∞–∫—É—é —Å—Ç–æ—Ä–æ–Ω—É —Å–º–æ—Ç—Ä–∏—Ç —Å—Ç–∞—Ç—É—è –•—Ä–∏—Å—Ç–∞-–ò—Å–∫—É–ø–∏—Ç–µ–ª—è –≤ –†–∏–æ-–¥–µ-–ñ–∞–Ω–µ–π—Ä–∞?", ["1) –Ω–∞ –≤–æ—Å—Ç–æ–∫","2) –Ω–∞ —é–≥","3) –Ω–∞ —Å–µ–≤–µ—Ä"], "1"),
    ("–£ –∫–∞–∫–æ–π –∏–∑ —ç—Ç–∏—Ö –ø–ª–∞–Ω–µ—Ç —Ç–≤–µ—Ä–¥–∞—è –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç—å?", ["1) –°–∞—Ç—É—Ä–Ω","2) –í–µ–Ω–µ—Ä–∞","3) –Æ–ø–∏—Ç–µ—Ä"], "2"),
    ("–ß—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç –≤–∞—à–µ '–∞–ª–∏–±–∏' –≤ –ø–µ—Ä–µ–≤–æ–¥–µ —Å –ª–∞—Ç–∏–Ω—Å–∫–æ–≥–æ?", ["1) '–Ω–µ–≤–∏–Ω–æ–≤–Ω–æ—Å—Ç—å'","2) '–ø—Ä–∞–≤–¥–∏–≤–∞—è –∏—Å—Ç–æ—Ä–∏—è'","3) '–≤ –¥—Ä—É–≥–æ–º –º–µ—Å—Ç–µ'"], "3"),
    ("–í –∫–∞–∫–æ–π —Å—Ç—Ä–∞–Ω–µ –µ—Å—Ç—å –±–∞–Ω–∫, –≥–¥–µ –≤–º–µ—Å—Ç–æ –¥–µ–Ω–µ–≥ –∑—Ä–∞–Ω—è—Ç —Å—ã—Ä?", ["1) –ì—Ä–µ—Ü–∏—è","2) –ò—Ç–∞–ª–∏—è","3) –®–≤–µ–¥—Ü–∞—Ä–∏—è"], "2"),
    # ("–í –∫–∞–∫–æ–π –Ω–∞—É–∫–µ –≠–Ω—à—Ç–µ–π–Ω –ø–æ–ª—É—á–∏–ª –Ω–æ–±–µ–ª–µ–≤—Å–∫—É—é –ø—Ä–µ–º–∏—é?", ["1) –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞", "2) —Ñ–∏–∑–∏–∫–∞", "3) —Ö–∏–º–∏—è"], "2"),
    # ("–ß—Ç–æ –∏–∑ —ç—Ç–æ–≥–æ –ø–æ—è–≤–∏–ª–æ—Å—å —Ä–∞–Ω—å—à–µ?", ["1) –î–∂–∏–Ω—Å—ã", "2) –ö–æ–∫–∞-–ö–æ–ª–∞", "3) –¢–æ—Å—Ç–µ—Ä—ã"], "1"),
]

def right_path():
    log("–ò–≥—Ä–æ–∫ –ø–æ—à—ë–ª –Ω–∞–ø—Ä–∞–≤–æ")
    print("\n--- –ü–†–ê–í–û: 10 –¥—É—à–µ—â–∏–ø–∞—Ç–µ–ª—å–Ω—ã—Ö –≤–æ–ø—Ä–æ—Å–æ–≤ –æ—Ç –û–≥—Ä–ú–∞–≥–∞---")
    for i, (q, opts, a) in enumerate(RIDDLES,1):
        print(f"\n–ó–∞–≥–∞–¥–∫–∞ {i}: {q}")
        for o in opts:
            print(o)
        ans = choose("–¢–≤–æ–π –æ—Ç–≤–µ—Ç (1/2/3): ", {"1","2","3"})
        log(f"–ó–∞–≥–∞–¥–∫–∞ {i}: –∏–≥—Ä–æ–∫ –æ—Ç–≤–µ—Ç–∏–ª {ans}, –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π {a}")
        if ans != a:
            print("üí•–ó–∞–¥–µ–π—Å—Ç–≤—É–π 100% üß†–º–æ–∑–≥–∞ –¥—Ä—É–∂–∏—â–µ)! –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ —Ä–∞–∑–≤–∏–ª–∫—É.")
            return False
    print("üî•–ü–æ–∑–¥—Ä–∞–≤–ª—è—é, —Ç—ã –æ—Ç–≤–µ—Ç–∏–ª(a) –Ω–∞ –≤—Å–µ –≤–æ–ø—Ä–æ—Å—ã –≤–µ—Ä–Ω–æ! –¢—ã —Ä–µ–∞–ª—å–Ω–æ genius bro!")
    log("üî•–ò–≥—Ä–æ–∫ —Ä–µ—à–∏–ª –≤—Å–µ –∑–∞–≥–∞–¥–∫–∏ ‚Äî –≤—ã–∏–≥—Ä–∞–ª (–ø—Ä–∞–≤–æ)")
    return True

while 1:
    print("–¢—ã –∏–≥—Ä–∞–µ—à—å –≤ –∏–≥—Ä—É –ë–∞–Ω–¥—ã—à–º—ã–≥!\nxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx")
    print("\n‚ò†Ô∏è–¢—ã –æ–∫–∞–∑–∞–ª—Å—è –≤ –æ–≥—Ä–æ–º–Ω–æ–º —Ç–µ–º–Ω–æ–º –ø–æ–¥–∑–µ–º–µ–ª—å–∏!‚ò†Ô∏è\n–ü–µ—Ä–µ–¥ —Ç–æ–±–æ–π —Ä–∞–∑–≤–∏–ª–∫–∞ —Å –º–æ–Ω—Å—Ç—Ä–∞–º–∏: –∫—É–¥–∞ –ø–æ–π–¥—ë—à—å?")
    print("1)‚¨ÖÔ∏è–ù–∞–ª–µ–≤–æ ‚Äî –°–∫–µ–ª–µ—Ç –∏ –í–∏–Ω–¥–∏–≥–æ")
    print("2)‚û°Ô∏è–ù–∞–ø—Ä–∞–≤–æ ‚Äî –û–ì–†-–ú–ê–ì")
    print("3)‚¨ÜÔ∏è–í–ø–µ—Ä–µ–¥ ‚Äî –ó–æ–º–±–∏–®—Ç–µ–π–Ω")
    print("4)‚õî–í—ã–π—Ç–∏")
    choice = choose("–í—ã–±–æ—Ä: ", {"1","2","3","4"})
    if choice=="1":
        if left_path(): break
    elif choice=="2":
        if right_path(): break
    elif choice=="3":
        if forward_path(): break
    else:
        print("–í—ã—Ö–æ–¥ –∏–∑ –∏–≥—Ä—ã")
        log("–ò–≥—Ä–æ–∫ –≤—ã—à–µ–ª")
        break

end_time = datetime.datetime.now()
duration = end_time - start_time
log(f"–°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {duration}")
print(f"\n–ò–≥—Ä–∞ –æ–∫–æ–Ω—á–µ–Ω–∞. –í—Ä–µ–º—è —Å–µ—Å—Å–∏–∏: {duration}")
print(f"–õ–æ–≥ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å–æ—Ö—Ä–∞–Ω—ë–Ω –≤: {log_file}")
